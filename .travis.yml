dist: bionic
language: python
python:
- '3.7'
stages:
- test
- name: pypi
  if: tag IS present
env:
  global:
  - secure: T3rTOQOLkdK0JBpX1QmcCT+PRDgo1FAZurlDTptEFb8r+9K9ab97sBIWi9GmRms9m699ButVeP6Md536DlQ2T+DpjpV1iJW3RKEnKzzJsvl8LjJXyYD7BZnP+p+8AR3y7aPJF8Vw2cUa15wKO0oWUAikjTmbO4QaBv4GESxTNtIQnRe7UX1g+IHfAXoljzPqj03WfsYT4wykt6nB/+wf/kpBW6uh4Y36yscxLZ7v6O2Gphyw/t9dJW5niMDptm0jFk80D41JXwrn3J9rKx9jzEQerqbw0toX6onZvd+S/FCUf0YV8lVKcvcOr8OnwYjsguQ2CxeM1zQEZ07SOa2dJjTxyk8MyyZqWHf8Gge2eDu4BTY+MdfQChPfpLI8ubtKipp2lN04MdQN0r+0qEiBU7z5aVOr7wH9CYLPvf8zzq/yEblhDyLnew9i6wO1aMZ8cJ9vo5J76ohDJp8sNLk6XXtuMGdXVsLPdkA8iseyRi16YbsEkYLzflEe3TKPhqzlF6IZGN76yNn2fWs0iqbrE1Rod20NioafiRSPYYgsDqzX/3iugx2KiETpHWpftmaAqBCTiJgQiCBUEwGlHDCRlmR48ovch8j9ZpF+V5HI2ienCQtzevPhWBvuaBupreWeKgI2YYDUXupgCTWEKsa2AvDv9T/0PvvDwgUmh6c9ews=
  - secure: FEDuEiQl4BK6Y9KJqqPr9/6/1ieundnmFX/jdm5m4SCQMyrEKuU3h4/1dkb9l0KRRXHPfmjPgbUSNcDitjbV6D4+bS6oEWMvJ5ZvFCsC+moaha67taim3OJKd7O2XVPj4Wryitl5hQobAVgOtKHozx77cL0xayr2t/J4e6q49cKsIZ4DkOs+Q8Z9Jwjc/Sw4ceXwmqHfXqb3wAotO4XfOS5uO1v7KluAw0BzYpTfa1ytxVXwIkxYZfFUO/1s92ZtufD7KqSgFx4EkJGHsve53pKyQb69XJaTL+5eyjAb3j05lxKYJSb0IyDZYiD3K2GS+BBMoId2gjYxJTsGG2fojwOaApvDrP3CE9ZpX20Kqz0AGhsurJFGaJLM81P3U+JmZuElgBhl82wUK5mk47+yIFn4s+RilRydsKwuM5Kd7ixrBsKqW+nE4VKWI+5wnkhE0fjZ7bqE5BxE1ATIM3sENylA+C0vjOTjplJpy3jtZ3e9Z76MdGEnlHsmEe4jPuadWR/ssj2D3ceEqeIu+07G6bOJF7opPIZRTN325rsQJm8p3HR1+HOZVhGwqErsXcj4cDCY5/acAzPio8hD3QDDqFyEdfU/iVblNXBZnr/d/1NskhMPkracw9akf6x4i1YpQZpdswJ/tm/I87phSVeRILOxIO98QYa3ajPJhoBwdUA=
  - secure: hzHC6GTaFUw81gzei4ypAtw1yZ/OvO1MPYyXHYp55R5SkX/ILo4LyOAIkS8rMCPGrkS/s7fKZDWSSLe820EPzbykXmW2k/yygFebOnkAZEjDRNfbY+NDGUl+MnVDcc65SgxqdmPScBj8FtQuTxbhOOgj1k9Vp2hEVeff5eN41sG4q7rpjVIwbfNGihLENbHX9JJuQOLwOv9/UE5kqpYqxWEyaDOSdlHLZuhW+BrGZzNR0PGF0zHuXIVFBi+VRwZQu4uQMoHtzYCB65x7rs7Mb3Bmi8m64uBWnrafBsfa0r3VMdXviDdtWhkWOmOOhxxraKJsQQVSDdxR9B/eUUK+n5OKCFisuiszpvqtYEEZOGVsFyj3RV/jXSfxwdwaFMUvQ5oOIwLv+3zgDB0QbeA23Y3o0im4cQwbrDHi22YP6cZjZXGJpW6/0eMG4DxknKu3dsZUVTOBDwqQW0KUmO34zhYRBNWZzNOBwHqNZE/wNq4QcahKv+yD/IxNFYz8lxpJZO/K6wfrByr+8AqrwTPTrHtlGEovUvmPi8SnsPZKtbG1KOc+k34tnhULRhb2u1B2psjyCHXsfBOziqizg0JSGKtXlZDF5459FpWRtXqclHZShYo9/OlrOktA50HY3cYyK80dNWMzDQLenZmqJm0ZmM+6mM0qJ6sSuDtk4JJEWcI=
  - secure: AwR3eLXgzhfyRKVedxiR+oKSYkxUOR49FLQImv0A4QE0QGRdMjpeLXgSpbQGYaMpspuohVmRGIzV7W0mCy9vUWHOFWfV4rdth9FvPPcCt3qr30FkZzWIrKPjz95Nxq/NEGXb9tSk1FMmKX5N1jVCrNiweXrOQPPC/2OVuflCHajt59G6OKQz34TbLOLETp3oQg+Gh3Y3inUV85Y0y0jOabLDbSpunN9q2mEFsBUzhwFFMCgO6OFl811mjFol6yfTfjIOSNit+5KjXKcGlpzhRxISNnYCpVOmi58QHyP+H+/pkR73wncDbU/ASTlQlsiF4gni4YFsKU4EQZ+ma82iYkUP1vrz8E+af12/mNYTj1+wG0LghLFjOWzFMHhNxNHjxZdWuuqTmlcVlR3hfABB1+Ep16O9GwIQ2g/ffTerudhTWML5EyycIIDvV4U/fio3GbjMwUdNzFCGydrjaC1cBKAMZ20xgkIk8vokKcHnmcY3qQTMAZw/k9yfdfSLU7kJFG251pJon82WgHc3H9h4BhAq1v6dUfzCo+ySoazWQ95h7fEoKyy8n3bB4RqYxn5eVQcxa1bA0Q1juKwyF2GLf4GFABZGQXOFgDQuCtl0V2zUiYrX4yAQzwocbKO/HQVW51Bz7JDMjLcgZmQj7/UzLO2rKigj5nhFY+NgkjkJZGo=
  - secure: N9Oj8gEufhumt1/tGNbmoVlNIi8g/INLdbPH6WPCOi6H7G9yLds46Vg5lY8foJ5Rz3ztlMMZHwsB56bJJJ7EIVpii/UrciQqb7dU3HUcVQU5UJk2k+ZnrqaCsBQCJff/q6M3CGUcR1DAXDfnafKkiM8I5Jcx4CrNMfFuwnUtlpYkTCG+UTUrnR4lTdpCHAv2rm03KtqUSybNXzF6evSMqBITQAKPk3AUKOPEv7QyS0Dt/pwOdCyVUIkVrjaD1vwKru33V6dY10B8ayDIt1LSzjadbmtYI2wWFPHa3ml6Itp6pYv5/wvxuwwkAFviPHIqZN5EuIwzQzZ39ucl/1VXQSEUB2Kx42PbA0aswGhonQGUJfrhhF53DViq8mwhJoRGeot+mSzosi37JWpsA88b91L25YaP82575jTTXRmahxgGvW8Lm8VHH9OShegFntNK0nOSqrccFZoWqXLZ+NUHBxJ2vDrNGvDE9LKaaZROaj7fu6Sc9drOZwv2BZbWH2tiIICT4xmnI9f4O2N2et/Fu3PGiRjKuhs7D/gFY0kbe/F7Y5bJJdLWu4pXr4WFO30OSt4/d6lswXBGAD6oH0kujue/TA0pQrgoO1j2rdlkBXBWSPrql/lUvUbtGPdHctkQ79vvPu3ug7eqHBNW8nltosPlZZG1yWaPlKP9RtdPpGw=
install:
- pip3 install poetry
- poetry install
jobs:
  include:
  - stage: test
    script: poetry run pytest
  - stage: pypi
    name: Deploy to PyPi
    script: poetry publish --build -u $PYPI_USERNAME -p $PYPI_PASSWORD
